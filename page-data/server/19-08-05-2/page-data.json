{"componentChunkName":"component---src-templates-post-js","path":"/server/19-08-05-2/","result":{"data":{"markdownRemark":{"html":"<p> 저번 AWS ACM 포스팅에서는 Route53과 AWS EC2를 사용하고 있는 내 서버에 ACM을 통해 SSL 인증서를 발급받는 방법을 알아보았습니다. 이번 포스팅에서는 발급받은 SSL인증서를 ELB라는 것을 이용해서 비교적 쉽게 서버에 적용하는 방법을 알아보도록 하겠습니다.</p>\n<h3 id=\"elb란-무엇인가\" style=\"position:relative;\"><a href=\"#elb%EB%9E%80-%EB%AC%B4%EC%97%87%EC%9D%B8%EA%B0%80\" aria-label=\"elb란 무엇인가 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ELB란 무엇인가?</h3>\n<p> ELB는 <strong>Elastic Load Balancing</strong>의 약자입니다. Load Balancing은 둘 혹은 셋 이상의 서버에게 작업을 나누는 것을 의미합니다. 이로써 가용성 및 응답시간을 최적화 시킬 수 있다는 장점을 가집니다. 또한 애플리케이션에 대한 요청의 전체적인 흐름을 방해하지 않고 필요에 따라 로드 밸런서에서 컴퓨팅 리소스를 추가 및 제거할 수도 있습니다. 아래의 서버 확장 방법 중 <strong>스케일 아웃</strong>의 경우에는 각 서버에 걸리는 부하를 균등하게 해주는 ‘로드밸런싱’이 필수적입니다.</p>\n<ul>\n<li>스케일 아웃: 서버 컴퓨터를 여러 대로 증가시켜 시스템을 확장하는 방법</li>\n<li>스케일 업: 서버 컴퓨터의 CPU, RAM 등을 고성능으로 업 그레이드 하는 방법</li>\n</ul>\n<p> AWS는 Application Load Balancer, Network Load Balancer, Classic Load Balancer의 세 가지 유형의 로드 밸런서를 지원합니다. 이 세가지 제품의 비교는 <a href=\"https://aws.amazon.com/ko/elasticloadbalancing/features/#compare\">이 링크</a>에서 확인 할 수 있습니다. </p>\n<h3 id=\"elb-생성하기\" style=\"position:relative;\"><a href=\"#elb-%EC%83%9D%EC%84%B1%ED%95%98%EA%B8%B0\" aria-label=\"elb 생성하기 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ELB 생성하기</h3>\n<p> 이전 포스팅의 방법대로 ACM 인증서를 생성했다고 가정하고 설명을 진행하겠습니다. 일단 EC2 콘솔에 접속한 뒤 왼쪽 메뉴에서 <strong>'로드 밸런서 - 로드 밸런서 생성'</strong> 버튼을 클릭하면 아래와 같은 화면이 나옵니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 760px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5dca457448e2b3a09b01bd3b5306b3f9/21b4d/19-08-05-3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.421052631578945%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABiklEQVQoz02S3W7aQBCF/f4P0av2DVo1atNwE1FSmgCtk5Qg/wGtUxN717GxjQ3+MrsKESONzpw5Z9dj7ThZ8g+d/ofDDvaSdFK39Me6by23+Krt93tMHA4Hm73UJk3Xefd1ztn1ks/jkE8/Aj4MHhhMV1y6f3l/MefjVWA1g4Zf3sZMbn5yfv6N4XDIeDwWHPFF+P2fOc7wV8CVG3Jx7TES/P474M6PeYgSjDZyo1ctsnwufd/3mM1muK7LdDLhVnA2nbJerXCqQqOU4i54ZPOUUZc59bagqbZSa7Isw/ViQWV5U5Vsq4qy3KK1IlqvBDVFUVDXNY4hSmkGN0vW8RN5LmJZyoHSGlOVM5iseNxklpuLiuKZLFWkacx0MSJTGzn3TCUfchaLBWEYENkM5Xd8MaYkSYLn+aKFLKOQKIqEe3biSiYx0ymdkxdbdruWtm3pug6naRpaKXTRsGs72zSvaMY3pkbMuhTPiXYa8shv0fc9zrHYH3qLx3U4NZ1qBo/rYlem79/S8BeDTleviLsy+QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/5dca457448e2b3a09b01bd3b5306b3f9/15813/19-08-05-3.webp 190w,\n/static/5dca457448e2b3a09b01bd3b5306b3f9/1cdb2/19-08-05-3.webp 380w,\n/static/5dca457448e2b3a09b01bd3b5306b3f9/9046c/19-08-05-3.webp 760w,\n/static/5dca457448e2b3a09b01bd3b5306b3f9/c89f9/19-08-05-3.webp 1140w,\n/static/5dca457448e2b3a09b01bd3b5306b3f9/af3f0/19-08-05-3.webp 1280w\"\n              sizes=\"(max-width: 760px) 100vw, 760px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/5dca457448e2b3a09b01bd3b5306b3f9/a2d4f/19-08-05-3.png 190w,\n/static/5dca457448e2b3a09b01bd3b5306b3f9/3f520/19-08-05-3.png 380w,\n/static/5dca457448e2b3a09b01bd3b5306b3f9/3c051/19-08-05-3.png 760w,\n/static/5dca457448e2b3a09b01bd3b5306b3f9/b5cea/19-08-05-3.png 1140w,\n/static/5dca457448e2b3a09b01bd3b5306b3f9/21b4d/19-08-05-3.png 1280w\"\n            sizes=\"(max-width: 760px) 100vw, 760px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/5dca457448e2b3a09b01bd3b5306b3f9/3c051/19-08-05-3.png\"\n            alt=\"img\"\n            title=\"img\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p> 여기서 <strong>Classic Load Balancer 생성</strong> 버튼을 클릭합니다. </p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 760px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2f2491408d171153d7c4e6c4c5a3e207/21b4d/19-08-05-4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.368421052631582%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAyUlEQVQY041Qyw6DIBDk/7+r1x6bNPVgtK3RggK+eIhOWYxN01M3mbAzLLuzMM452raFlBKtECn/hVIKwzBgHMcPDv59TtMEJmKTLLvhxQXujyeapo4F++U8z1iWBSEE/BuMGuV5AWM9rNsf+yV8Gq3rmk7ih3bkvxrVsrouUBZXyK5G3/fQWqGq8rQqcULXdSjLMrpv0vqk0WbEtdYJpNG3MSXPEPwEM1+wbVuc5mDNOZoPke9reO9TsTEGzrmkWWuTKwpyRkHD3k+KgXqEd3ZYAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/2f2491408d171153d7c4e6c4c5a3e207/15813/19-08-05-4.webp 190w,\n/static/2f2491408d171153d7c4e6c4c5a3e207/1cdb2/19-08-05-4.webp 380w,\n/static/2f2491408d171153d7c4e6c4c5a3e207/9046c/19-08-05-4.webp 760w,\n/static/2f2491408d171153d7c4e6c4c5a3e207/c89f9/19-08-05-4.webp 1140w,\n/static/2f2491408d171153d7c4e6c4c5a3e207/af3f0/19-08-05-4.webp 1280w\"\n              sizes=\"(max-width: 760px) 100vw, 760px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/2f2491408d171153d7c4e6c4c5a3e207/a2d4f/19-08-05-4.png 190w,\n/static/2f2491408d171153d7c4e6c4c5a3e207/3f520/19-08-05-4.png 380w,\n/static/2f2491408d171153d7c4e6c4c5a3e207/3c051/19-08-05-4.png 760w,\n/static/2f2491408d171153d7c4e6c4c5a3e207/b5cea/19-08-05-4.png 1140w,\n/static/2f2491408d171153d7c4e6c4c5a3e207/21b4d/19-08-05-4.png 1280w\"\n            sizes=\"(max-width: 760px) 100vw, 760px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/2f2491408d171153d7c4e6c4c5a3e207/3c051/19-08-05-4.png\"\n            alt=\"img\"\n            title=\"img\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p> 1단계에서는 HTTPS 로드 밸런서 프로토콜을 추가하고, 로드 밸런서 이름에는 자신이 원하는 로드밸런서 이름을 설정합니다. 다음으로 가면 2단계에서는 보안그룹을 할당해야 하는데 여기서는 자신이 서버 컴퓨터에 사용하는 보안그룹을 할당하시면 됩니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 760px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/abffe88f44e89c34460fe257fce9d31e/21b4d/19-08-05-5.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABNklEQVQoz5VRi07DMAzs//8c2tDQXgWNVbC+aJM0j6ZJDzvdYEJICEsX27V9ubjZ6XRCURRo2xbeR8QIhABMdDAC+2ki/BJf60vMszMyKSWUkpBSoO9f0DZP6Lsd9CBgtIYxmuLhO9ZLbI1Jub3WlXZw44QMZNYHlK3E+XLEa7FCJ3KEeQYJhpsi7BhST/JXGBo21GD9DGr9smymrFcW57LD5nDGw+MBq02OzY6wf0ZxafAhDRqhCQOafkHdKcrpuxrh6VLmYWRNXadn+HHE5f0N+/0OeX7EdrvFer1CXVWYvIe1NvWMDOeSd6MnspCIeH+JcKC3N+0HhBCpiZce43KjoyfxEJMx3I2IvVt2dq8uEUY6yrJCRUo0LduTGv5rXBS0CjUY/MeyG/NPSwpJFa/jXsFf+AQNpWzsjMbzbQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/abffe88f44e89c34460fe257fce9d31e/15813/19-08-05-5.webp 190w,\n/static/abffe88f44e89c34460fe257fce9d31e/1cdb2/19-08-05-5.webp 380w,\n/static/abffe88f44e89c34460fe257fce9d31e/9046c/19-08-05-5.webp 760w,\n/static/abffe88f44e89c34460fe257fce9d31e/c89f9/19-08-05-5.webp 1140w,\n/static/abffe88f44e89c34460fe257fce9d31e/af3f0/19-08-05-5.webp 1280w\"\n              sizes=\"(max-width: 760px) 100vw, 760px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/abffe88f44e89c34460fe257fce9d31e/a2d4f/19-08-05-5.png 190w,\n/static/abffe88f44e89c34460fe257fce9d31e/3f520/19-08-05-5.png 380w,\n/static/abffe88f44e89c34460fe257fce9d31e/3c051/19-08-05-5.png 760w,\n/static/abffe88f44e89c34460fe257fce9d31e/b5cea/19-08-05-5.png 1140w,\n/static/abffe88f44e89c34460fe257fce9d31e/21b4d/19-08-05-5.png 1280w\"\n            sizes=\"(max-width: 760px) 100vw, 760px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/abffe88f44e89c34460fe257fce9d31e/3c051/19-08-05-5.png\"\n            alt=\"img\"\n            title=\"img\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p> 3단계는 사용 할 인증서를 선택하는 단계입니다. 우리는 ACM으로 인증서를 생성하였기 때문에 <strong>ACM 인증서 선택</strong>을 체크하고 다음단계로 넘어갑니다. </p>\n<p> 4단계에서는 원하는 상태구성을 자유롭게 설정하시면 되고, 5단계에서는 사용할 인스턴스를 선택하시면 됩니다. 그리고 태그 추가 및 검토를 하면 Classic Load Balancer가 성공적으로 생성됩니다. 로드 밸런서의 상태가 아래와 같이 In service 이면 정상 동작하는 것입니다.</p>\n<h3 id=\"도메인에-elb-연결\" style=\"position:relative;\"><a href=\"#%EB%8F%84%EB%A9%94%EC%9D%B8%EC%97%90-elb-%EC%97%B0%EA%B2%B0\" aria-label=\"도메인에 elb 연결 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>도메인에 ELB 연결</h3>\n<p> ELB를 생성했다면 이를 우리의 웹 사이트 도메인과 연결해야 합니다. Route53의 호스팅영역에 들어가서 자신이 사용하고 있는 도메인을 클릭합니다. 그리고 <strong>레코드 세트 생성</strong> 버튼을 클릭하면 아래와 같은 화면이 나타납니다.  </p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 760px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9a2e167e97d9df1ed39e825cbf7e380c/21b4d/19-08-05-6.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.421052631578945%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAxElEQVQoz52QSQ7DIAxFuf/xuumuVaV0goQhEIYk5BfTZh+K9EAI+xmb3V4G3Kw/Mk7nKy63O+IK+JQLWxNM2YSnMLDTAuszeC9htAKtbcu0HQdF+HgPEGKAHHr0vYAxBt4HODfBTQ2U+BAiWPC+CDzGcawyOpdlKQW3ZnLOYDHGKrHWYp7n2io9tMr2vCrsuq5Kd9G/i3KZlBJaa6ylTWqVCnwJZSbHobmnlMA451VIP1RKge6D0hDaYSpDpjFQ4BEo9gP2uHEEuzq4owAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/9a2e167e97d9df1ed39e825cbf7e380c/15813/19-08-05-6.webp 190w,\n/static/9a2e167e97d9df1ed39e825cbf7e380c/1cdb2/19-08-05-6.webp 380w,\n/static/9a2e167e97d9df1ed39e825cbf7e380c/9046c/19-08-05-6.webp 760w,\n/static/9a2e167e97d9df1ed39e825cbf7e380c/c89f9/19-08-05-6.webp 1140w,\n/static/9a2e167e97d9df1ed39e825cbf7e380c/af3f0/19-08-05-6.webp 1280w\"\n              sizes=\"(max-width: 760px) 100vw, 760px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/9a2e167e97d9df1ed39e825cbf7e380c/a2d4f/19-08-05-6.png 190w,\n/static/9a2e167e97d9df1ed39e825cbf7e380c/3f520/19-08-05-6.png 380w,\n/static/9a2e167e97d9df1ed39e825cbf7e380c/3c051/19-08-05-6.png 760w,\n/static/9a2e167e97d9df1ed39e825cbf7e380c/b5cea/19-08-05-6.png 1140w,\n/static/9a2e167e97d9df1ed39e825cbf7e380c/21b4d/19-08-05-6.png 1280w\"\n            sizes=\"(max-width: 760px) 100vw, 760px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/9a2e167e97d9df1ed39e825cbf7e380c/3c051/19-08-05-6.png\"\n            alt=\"img\"\n            title=\"img\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p> 여기서 <strong>별칭을 '예'로 선택</strong>하면 우리가 생성한 ELB를 선택 할 수 있습니다. 우리가 생성한 ELB 를 선택한 뒤 생성 버튼을 클릭합니다. 그리고 5분 정도 뒤에 도메인으로 접속해서 https가 제대로 접속되는지 확인하면 끝 입니다!</p>\n<p> 혹여나 접속이 제대로 되지 않는 분 들은 서버 컴퓨터에 적용되어있는 <strong>EC2 내 보안그룹</strong>을 확인 해 보시길 바랍니다. 아래 처럼 HTTPS 접속이 허용되어 있어야 HTTPS 주소로 접속이 가능합니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 760px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a1a9d94155c0a583a4d7133ebbd6117d/21b4d/19-08-05-7.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 29.47368421052632%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA60lEQVQY011Qy26EMBDj/3+tPVTqDUQpIN4kQMjyBnc9q6BVD9Z44ozHiReGIYIggO/7aJoGwzCg7/sb7B3ez532zrXW8NI0RZIkyLJMTMuyRBRFiONYOCu1PM+lJ6qqkp73iqK4Qc3TWkGpFtaOsmnfdxhjsK6rcJoRXddhWRZs2yYaoZRC27YCa+0roTH2OVA+I4+Y5xnXdWEcRxkmr+taNnMJzY7jkEWs7pk0nqZJqtd3P0jTL5jhF4+HFRMO88J5nmLG5zG9S+3A1DRxhq+Ewwe0+sQyf9+GFJmG3P0XU/PMmTEhl/xP+Af1JcfXJHdkcgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/a1a9d94155c0a583a4d7133ebbd6117d/15813/19-08-05-7.webp 190w,\n/static/a1a9d94155c0a583a4d7133ebbd6117d/1cdb2/19-08-05-7.webp 380w,\n/static/a1a9d94155c0a583a4d7133ebbd6117d/9046c/19-08-05-7.webp 760w,\n/static/a1a9d94155c0a583a4d7133ebbd6117d/c89f9/19-08-05-7.webp 1140w,\n/static/a1a9d94155c0a583a4d7133ebbd6117d/af3f0/19-08-05-7.webp 1280w\"\n              sizes=\"(max-width: 760px) 100vw, 760px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/a1a9d94155c0a583a4d7133ebbd6117d/a2d4f/19-08-05-7.png 190w,\n/static/a1a9d94155c0a583a4d7133ebbd6117d/3f520/19-08-05-7.png 380w,\n/static/a1a9d94155c0a583a4d7133ebbd6117d/3c051/19-08-05-7.png 760w,\n/static/a1a9d94155c0a583a4d7133ebbd6117d/b5cea/19-08-05-7.png 1140w,\n/static/a1a9d94155c0a583a4d7133ebbd6117d/21b4d/19-08-05-7.png 1280w\"\n            sizes=\"(max-width: 760px) 100vw, 760px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/a1a9d94155c0a583a4d7133ebbd6117d/3c051/19-08-05-7.png\"\n            alt=\"img\"\n            title=\"img\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h3 id=\"http-접속을-https-로-변경하기\" style=\"position:relative;\"><a href=\"#http-%EC%A0%91%EC%86%8D%EC%9D%84-https-%EB%A1%9C-%EB%B3%80%EA%B2%BD%ED%95%98%EA%B8%B0\" aria-label=\"http 접속을 https 로 변경하기 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>HTTP 접속을 HTTPS 로 변경하기</h3>\n<p> HTTP접속을 HTTPS로 리다이렉트하는 코드를 작성하기 위해서는 먼저 연결에 사용한 프로토콜이 무엇이었는지 식별해야 합니다. AWS의 <a href=\"https://docs.aws.amazon.com/ko_kr/elasticloadbalancing/latest/classic/x-forwarded-headers.html\">ELB 사용설명서</a>를 참고하면 ELB의 Classic Load Balancer는 아래와 같은 X-Forwarded 헤더를 지원한다고 합니다. 저는 이 중 X-Forwarded-Proto 헤더를 이용하겠습니다.</p>\n<ul>\n<li>X-Forwarded-For : HTTP 또는 HTTPS 로드 밸런서를 사용할 때 클라이언트의 IP를 식별하는데 도움을 줌</li>\n<li>X-Forwarded-Proto : 클라이언트가 로드 밸런서 연결에 사용한 프로토콜(HTTP 또는 HTTPS)을 식별하는데 도움을 줌</li>\n<li>X-Forwarded-Port : 클라이언트가 로드 밸런서 연결에 사용한 대상 포트를 식별하는 데 도움을 줍니다.</li>\n</ul>\n<p> X-Forwarded 헤더를 이용하기 위해서 저는 Express의 request 객체 내 기본으로 내장된 <code class=\"language-text\">get()</code> 메소드를 활용해보도록 하겠습니다. request 객체에 대한 <a href=\"https://expressjs.com/ko/api.html#req.get\">Express 사용설명서</a>를 참고하여 아래와 같이 코드를 작성해 보았습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> app <span class=\"token operator\">=</span> <span class=\"token function\">express</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res<span class=\"token punctuation\">,</span> next</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">var</span> xForwarded <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'X-Forwarded-Proto'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>xForwarded <span class=\"token operator\">!==</span> <span class=\"token string\">'https'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    \tres<span class=\"token punctuation\">.</span><span class=\"token function\">redirect</span><span class=\"token punctuation\">(</span><span class=\"token string\">'https://'</span> <span class=\"token operator\">+</span> req<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Host'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> req<span class=\"token punctuation\">.</span>url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p> 만약 우리가  <code class=\"language-text\">http://example.com/home</code> 으로 접속하면 xForwarded에는 http가 담기게 되고, 그렇기 때문에 if 문이 실행되어  <code class=\"language-text\">https://example.com/home</code> 으로 리다이렉트 됩니다.</p>","tableOfContents":"<ul>\n<li><a href=\"/Web/19-08-05-ELB%EB%A5%BC%20%EC%9D%B4%EC%9A%A9%ED%95%98%EC%97%AC%20SSL%EC%9D%B8%EC%A6%9D%EC%84%9C%20%EC%A0%81%EC%9A%A9%ED%95%98%EA%B8%B0/#elb%EB%9E%80-%EB%AC%B4%EC%97%87%EC%9D%B8%EA%B0%80\">ELB란 무엇인가?</a></li>\n<li><a href=\"/Web/19-08-05-ELB%EB%A5%BC%20%EC%9D%B4%EC%9A%A9%ED%95%98%EC%97%AC%20SSL%EC%9D%B8%EC%A6%9D%EC%84%9C%20%EC%A0%81%EC%9A%A9%ED%95%98%EA%B8%B0/#elb-%EC%83%9D%EC%84%B1%ED%95%98%EA%B8%B0\">ELB 생성하기</a></li>\n<li><a href=\"/Web/19-08-05-ELB%EB%A5%BC%20%EC%9D%B4%EC%9A%A9%ED%95%98%EC%97%AC%20SSL%EC%9D%B8%EC%A6%9D%EC%84%9C%20%EC%A0%81%EC%9A%A9%ED%95%98%EA%B8%B0/#%EB%8F%84%EB%A9%94%EC%9D%B8%EC%97%90-elb-%EC%97%B0%EA%B2%B0\">도메인에 ELB 연결</a></li>\n<li><a href=\"/Web/19-08-05-ELB%EB%A5%BC%20%EC%9D%B4%EC%9A%A9%ED%95%98%EC%97%AC%20SSL%EC%9D%B8%EC%A6%9D%EC%84%9C%20%EC%A0%81%EC%9A%A9%ED%95%98%EA%B8%B0/#http-%EC%A0%91%EC%86%8D%EC%9D%84-https-%EB%A1%9C-%EB%B3%80%EA%B2%BD%ED%95%98%EA%B8%B0\">HTTP 접속을 HTTPS 로 변경하기</a></li>\n</ul>","frontmatter":{"path":"/server/19-08-05-2/","title":"ELB를 이용하여 SSL인증서 적용하기","category":"BackEnd","date":"2019-08-05"}}},"pageContext":{}},"staticQueryHashes":["2390655019","256249292","63159454"]}